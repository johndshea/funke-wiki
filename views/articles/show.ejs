<div class="article card hoverable">
  <div class="card-content black-text">
    <h5><%= article.published.title %></h5>
    <hr/>
    <div class="flow-text"><%- content %></div>
    <hr/>
    Author: <%= article.authorName %><br/>
    Tags: <%= article.published.tags.join(', ') %> <br/>
    Last Edited: <%= article.published.last_edited || "never" %> <br/>
  </div>
  <div class="card-action">
    <a href="/articles/<%= article._id %>/edit">Edit this article</a>
  </div>
</div>

<!-- Change the foreach loop to be a decrementing for loop - should fix the backward edit/draft ordering problem -->

<ul class="collapsible hoverable" data-collapsible="accordion">
  <% article.drafts.forEach(function (draft, i) { %>
      <li>
        <div class="collapsible-header"><i class="material-icons">spellcheck</i>Draft # <%= i %> </div>
        <div class="collapsible-body">
          <p>
            <%= draft.title %>
            <span class="title truncate"> <%= draft.content %> </span>
            Tags: <%= draft.tags.join(', ') || "none" %> <br/>
            Editor: <%= draft.editorName || "Anonymous" %><br/>
            Last Edited: <%= draft.last_edited || "never" %> <br/>
          </p>
        </div>
      </li>
  <% }) %>
</ul>

<ul class="collapsible hoverable" data-collapsible="accordion">
  <% article.history.forEach(function (oldVersion, i) { %>
      <li>
        <div class="collapsible-header"><i class="material-icons">settings_backup_restore</i>Archived Version # <%= i %> </div>
        <div class="collapsible-body">
          <p>
            <%= oldVersion.title %>
            <span class="title truncate"> <%= oldVersion.content %> </span>
            Tags: <%= oldVersion.tags.join(', ') || "none" %> <br/>
            Editor: <%= oldVersion.editorName || "Anonymous" %><br/>
            Last Edited: <%= oldVersion.last_edited || "never" %> <br/>
          </p>
        </div>
      </li>
  <% }) %>
</ul>
